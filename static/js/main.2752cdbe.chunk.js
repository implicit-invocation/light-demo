(this["webpackJsonplight-gdxjs"]=this["webpackJsonplight-gdxjs"]||[]).push([[0],{28:function(t,e,i){t.exports=i(57)},30:function(t,e,i){},57:function(t,e,i){"use strict";i.r(e);var n=i(3),h=i.n(n),s=i(6),a=(i(30),i(1)),r=i(0),o=function(){function t(e,i){Object(a.a)(this,t),this.cellTypes=e,this.cellStates=e.map((function(t){return!0})),this.clicked=e.map((function(t){return!1})),this.columnCount=i,this.cellCount=e.length,this.toggleListeners=[],this.history=[]}return Object(r.a)(t,null,[{key:"random",value:function(e,i){for(var n=[],h=0;h<e;h++)n.push(Math.floor(4*Math.random()));return new t(n,i)}}]),Object(r.a)(t,[{key:"getWidth",value:function(){return this.columnCount}},{key:"getHeight",value:function(){return this.cellCount/this.columnCount}},{key:"addToggleListener",value:function(t){var e=this;return this.toggleListeners.push(t),function(){e.toggleListeners=e.toggleListeners.filter((function(e){return e!==t}))}}},{key:"toggle",value:function(t){t>=0&&t<this.cellCount&&(this.cellStates[t]=!this.cellStates[t])}},{key:"isWinning",value:function(){for(var t=0;t<this.cellStates.length;t++)if(!this.cellStates[t])return!1;return!0}},{key:"shuffle",value:function(t){var e=0;for(this.silent=!0;e<t;){var i=Math.floor(Math.random()*this.cellCount);this.clicked[i]||(this.hit(i),e++)}this.silent=!1,this.history.length=0}},{key:"fireEvent",value:function(t,e){this.silent||this.toggleListeners.map((function(i){return i(t,e)}))}},{key:"toggleXY",value:function(t,e,i,n){var h=this.columnCount,s=Math.ceil(this.cellCount/h);if(t>=0&&t<h&&e>=0&&e<s){var a=e*h+t;if(this.toggle(a),!i){switch(this.cellTypes[a]){case 1:this.toggleXY(t,e-1,!0,n+1);break;case 2:this.toggleXY(t,e+1,!0,n+1);break;case 3:this.toggleXY(t-1,e,!0,n+1);break;case 4:this.toggleXY(t+1,e,!0,n+1)}this.fireEvent(a,n)}}}},{key:"hit",value:function(t){this.history.push(t),this.clicked[t]=!this.clicked[t];var e=t%this.columnCount,i=Math.floor(t/this.columnCount),n=this.cellTypes[t],h=this.toggleXY.bind(this);switch(n){case 0:h(e,i,!0,0),h(e+1,i,!1,0),h(e-1,i,!1,0),h(e,i+1,!1,0),h(e,i-1,!1,0);break;case 1:case 2:case 3:case 4:h(e+1,i,!1,0),h(e-1,i,!1,0),h(e,i+1,!1,0),h(e,i-1,!1,0)}this.fireEvent(t,-1)}},{key:"undo",value:function(){0!==this.history.length&&(this.hit(this.history.pop()),this.history.pop())}},{key:"reset",value:function(){for(this.silent=!0;this.history.length>0;)this.undo();this.silent=!1}}]),t}(),l=i(2),c=["circle","up","down","left","right"],u=function(){function t(e,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(a.a)(this,t),this.padX=0,this.padY=0,this.gridSize=0,this.effects=[],this.width=e,this.height=i,e>i?(this.gridSize=(i-2*n)/4,this.padY=n,this.padX=n+(e-i)/2):(this.gridSize=(e-2*n)/4,this.padX=n,this.padY=n+(i-e)/2)}return Object(r.a)(t,[{key:"setBoard",value:function(t){var e=this;this.board=t,t.addToggleListener((function(i,n){-1===n?e.effects.push({type:0,index:i,duration:500,startTime:Date.now(),delay:0}):0===n&&0!==t.cellTypes[i]&&e.effects.push({type:t.cellTypes[i],index:i,duration:500,startTime:Date.now(),delay:50})}))}},{key:"drawCell",value:function(t,e,i,n){var h=this.board,s=this.gridSize,a=this.padX,r=this.padY,o=e*h.getWidth()+t,l=.8*s,u=h.cellTypes[o],d=h.cellStates[o]?1:0,g=c[u],f=n.findRegion(g,d),p=l/Math.max(f.width,f.height);f.draw(i,a+t*s-f.width/2+s/2,r+e*s-f.height/2+s/2,f.width,f.height,f.width/2,f.height/2,0,p,p)}},{key:"drawFx",value:function(t,e,i){var n=this.board,h=this.gridSize,s=this.padX,a=this.padY,r=(Date.now()-t.startTime)/t.duration,o=n.getWidth(),l=t.index%o,u=Math.floor(t.index/o),d=.8*h,g=c[t.type],f=i.findRegion(g,1),p=d/Math.max(f.width,f.height);switch(e.setColor(1,1,1,1-r),t.type){case 1:f.draw(e,s+l*h-f.width/2+h/2,a+u*h-f.height/2+h/2-r*h,f.width,f.height,f.width/2,f.height/2,0,p,p);break;case 2:f.draw(e,s+l*h-f.width/2+h/2,a+u*h-f.height/2+h/2+r*h,f.width,f.height,f.width/2,f.height/2,0,p,p);break;case 3:f.draw(e,s+l*h-f.width/2+h/2-r*h,a+u*h-f.height/2+h/2,f.width,f.height,f.width/2,f.height/2,0,p,p);break;case 4:f.draw(e,s+l*h-f.width/2+h/2+r*h,a+u*h-f.height/2+h/2,f.width,f.height,f.width/2,f.height/2,0,p,p);break;default:e.setColor(1,1,1,(1-r)/2),f.draw(e,s+l*h-f.width/2+h/2,a+u*h-f.height/2+h/2,f.width,f.height,f.width/2,f.height/2,0,p*(1.3/Math.max(.3,1-r)),p*(1.3/Math.max(.3,1-r)))}e.setColor(1,1,1,1)}},{key:"render",value:function(t,e){for(var i=this.board,n=this.effects,h=i.getWidth(),s=i.getHeight(),a=Date.now(),r=n.length-1;r>=0;r--){var o=n[r];a-o.startTime>o.duration&&n.splice(r,1)}var c,u=Object(l.a)(n);try{for(u.s();!(c=u.n()).done;){var d=c.value;a-d.startTime>=d.delay&&this.drawFx(d,t,e)}}catch(p){u.e(p)}finally{u.f()}for(var g=0;g<h;g++)for(var f=0;f<s;f++)this.drawCell(g,f,t,e)}}]),t}(),d=i(5),g=function(t,e,i,n){var h,s,a,r,o=!0;return t>e?(s=(e-2*i)/4,r=i,a=i+(t-e)/2):(s=(t-2*i)/4,a=i,r=i+(e-t)/2),n.addEventListener("touchStart",(function(){if(h&&o){var t=n.getTouchedWorldCoord(),e=t.x,i=t.y;e=Math.floor((e-a)/s),i=Math.floor((i-r)/s),e<0||e>3||i<0||i>3||h.hit(e+i*h.getWidth())}})),{enable:function(){o=!0},disable:function(){o=!1},setBoard:function(t){h=t}}},f=i(19),p=function(t){return new Promise((function(e){var i=new f.Howl({src:[t],onload:function(){return e(i)}})}))};(function(){var t=Object(s.a)(h.a.mark((function t(){var e,i,n,s,a,r,l,c,f,v,w,y,b,m,k,C,x,T,j,M,O,S,L,X,Y;return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=Object(d.c)(),i=e.getCanvas(),n=e.getInfo(),s=document.getElementById("loader"),a=60,r=100,l=10,c=Object(d.d)(i,a,r,{crop:!1}),f=c.getContext(),v=c.getCamera(),w=Object(d.e)(i,c),y=Object(d.a)(f),t.next=13,Object(d.f)(f,"./symbol-78.atlas");case 13:return b=t.sent,m=new u(a,r,l),k=g(a,r,l,w),t.next=18,p("./click.mp3");case 18:return C=t.sent,t.next=21,p("./win.mp3");case 21:x=t.sent,(j=function(){(T=o.random(16,4)).shuffle(3),m.setBoard(T),k.setBoard(T),T.addToggleListener((function(t,e){-1!==e||T.isWinning()||C.play()}))})(),s.remove(),2,M=!1,O=0,S=2,L=10*Math.max(a,r),X=b.findRegion("circle",1),f.clearColor(0,0,0,0),Y=Object(d.b)((function(t){f.clear(f.COLOR_BUFFER_BIT),y.setProjection(v.combined),y.begin(),!M&&T.isWinning()&&(x.play(),M=!0,k.disable()),M&&((O+=S)>=60&&(S=-2,O=60,j()),O<=0&&(O=0,S=2,M=!1,k.enable()),y.setColor(1,1,1,1-(60-O)/60),X.draw(y,a/2-L/2,r/2-L/2,L,L),y.setColor(1,1,1,1)),m.render(y,b),y.end()})),setInterval((function(){return n.innerHTML="FPS: ".concat(Y.getFps())}),500),n.style.display="none";case 35:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}})()()}},[[28,1,2]]]);
//# sourceMappingURL=main.2752cdbe.chunk.js.map